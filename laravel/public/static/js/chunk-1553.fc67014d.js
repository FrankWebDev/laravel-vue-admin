(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1553"],{19:function(e,t){},20:function(e,t){},"5EWB":function(e,t,a){"use strict";a.r(t);var o=a("4d7F"),l=a.n(o),r=a("EUZL"),n=a.n(r),s=a("t3Un"),i={data:function(){return{fileList:[],upLoadNumber:1e5,tableTitle:"",tableData:[],tableHeader:"",uploadUrl:"https://up.qiniup.com",dialogImageUrl:"",dialogVisible:!1,desc:"",dataObj:{}}},created:function(){var e=this;s.a.get("/api/getToken").then(function(t){e.dataObj={token:t.data.token},console.log(e.dataObj)})},methods:{submitUpload:function(){this.$refs.upload.submit()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},beforeUpload:function(e){var t=this;return new l.a(function(a,o){t.readExcel(e).then(function(e){e&&a(e)})})},readExcel:function(e){console.log(e);var t=this;return new l.a(function(a,o){var l=new FileReader;l.onload=function(e){try{var l=e.target.result,r=n.a.read(l,{type:"binary"}),s=[];for(var i in console.log(r.SheetNames),r.SheetNames){console.log(i);var c=r.SheetNames[i],u=r.Sheets[c];for(var d in u)"!ref"!==d&&s.push(u[d])}var f=n.a.utils.sheet_to_json(r.Sheets[r.SheetNames[0]]);console.log(f);var h=r.SheetNames[0];console.log(h);var p=r.Sheets[r.SheetNames[0]],g=t.get_header_row(p);console.log(g);var v=n.a.utils.sheet_to_json(p);console.log(v),t.generateDate({tableTitle:h,header:g,results:v}),s.length>t.upLoadNumber?(console.log("不能超过"),a(!1)):a(!0)}catch(e){o(e.message)}},l.readAsBinaryString(e)})},generateDate:function(e){var t=e.tableTitle,a=e.header,o=e.results;console.log(t),console.log(a),console.log(o),this.tableTitle=t,this.tableData=o,this.tableHeader=a},handleDrop:function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;if(1===t.length){var a=t[0];this.readerData(a),e.stopPropagation(),e.preventDefault()}else this.$message.error("Only support uploading one file!")},handleDragover:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},readerData:function(e){var t=this;if("xls"!==e.name.split(".")[1]&&"xlsx"!==e.name.split(".")[1])this.$message({message:"上传文件格式错误，请上传xls、xlsx文件！",type:"warning"});else{var a=new FileReader;a.onload=function(e){var a=e.target.result,o=t.fixdata(a),l=n.a.read(btoa(o),{type:"base64"}),r=l.SheetNames[0];console.log(r);var s=l.Sheets[r],i=s["!ref"].split(":")[1];s["!ref"]="A2:"+i;var c=r,u=t.get_header_row(s);console.log(u);var d=n.a.utils.sheet_to_json(s);console.log(d),t.generateDate({tableTitle:c,header:u,results:d})},a.readAsArrayBuffer(e)}},fixdata:function(e){var t="",a=0,o=10240;for(a=0;a<e.byteLength/o;++a)return t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(a*o,a*o+o))),t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(a*o)))},get_header_row:function(e){var t=[],a=n.a.utils.decode_range(e["!ref"]),o=void 0,l=a.s.r;for(o=a.s.c;o<=a.e.c;++o){var r,s=e[n.a.utils.encode_cell({c:o,r:l})];r=n.a.utils.format_cell(s),t.push(r)}return t}}},c=(a("Kcnb"),a("KHd+")),u=Object(c.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("nav-bar"),e._v(" "),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{data:e.dataObj,action:e.uploadUrl,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-upload":e.beforeUpload,"file-list":e.fileList}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传 Excel 文件，且不超过 500kb")])],1),e._v(" "),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("数据预览")])]),e._v(" "),a("div",{staticClass:"text item"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:e.tableTitle}},e._l(e.tableHeader,function(e){return a("el-table-column",{key:e,attrs:{prop:e,label:e,"min-width":"150"}})}))],1)],1)])],1)},[],!1,null,"b740b914",null);u.options.__file="excel.vue";t.default=u.exports},9:function(e,t){},C75F:function(e,t,a){},Kcnb:function(e,t,a){"use strict";var o=a("C75F");a.n(o).a}}]);
